const canvas=document.getElementById("network-bg"),ctx=canvas.getContext("2d"),prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,isLowPowerDevice=navigator.hardwareConcurrency&&navigator.hardwareConcurrency<=4||navigator.deviceMemory&&navigator.deviceMemory<=4;let particles=[],mouse={x:null,y:null,radius:200,lastX:null,lastY:null,velocity:{x:0,y:0},trail:[]};const particleCount=isLowPowerDevice?window.innerWidth<768?28:48:window.innerWidth<768?44:90,particleColors=["#ff003c","#ff4d6d","#ff809b","#ff1a47","#ff6680","#cc0033","#e60039","#ff3358","#ff5c7a","#ff8ca3"],lineColor="rgba(255, 0, 60, 0.4)";canvas.width=window.innerWidth,canvas.height=window.innerHeight;let canvasRect=canvas.getBoundingClientRect(),animationTime=0,lastFrameTime=0;const frameInterval=prefersReducedMotion?1e3:isLowPowerDevice?33:20;class Particle{constructor(t,e){this.x=t,this.y=e,this.baseX=t,this.baseY=e,this.size=4*Math.random()+1,this.baseSize=this.size,this.speedX=2*Math.random()-1,this.speedY=2*Math.random()-1,this.density=40*Math.random()+10,this.opacity=.8*Math.random()+.2,this.baseOpacity=this.opacity,this.angle=Math.random()*Math.PI*2,this.angleSpeed=.02*(Math.random()-.5),this.pulsePhase=Math.random()*Math.PI*2,this.colorIndex=Math.floor(Math.random()*particleColors.length),this.trail=[],this.maxTrailLength=5,this.magneticForce={x:0,y:0},this.orbitalRadius=100*Math.random()+50,this.isOrbiting=!1,this.energy=100*Math.random()}update(){if(animationTime+=.003,null!==mouse.x&&null!==mouse.y&&(null!==mouse.lastX&&null!==mouse.lastY&&(mouse.velocity.x=mouse.x-mouse.lastX,mouse.velocity.y=mouse.y-mouse.lastY),mouse.lastX=mouse.x,mouse.lastY=mouse.y),this.trail.unshift({x:this.x,y:this.y,opacity:this.opacity}),this.trail.length>this.maxTrailLength&&this.trail.pop(),null!==mouse.x&&null!==mouse.y){const t=mouse.x-this.x,e=mouse.y-this.y,i=Math.sqrt(t*t+e*e),s=mouse.radius;if(i<s){const a=Math.sqrt(mouse.velocity.x**2+mouse.velocity.y**2),o=Math.max(.3,.1*a);if(i<.3*s){this.isOrbiting=!0;const a=Math.atan2(e,t)+1.5*this.angleSpeed;this.x=mouse.x+Math.cos(a)*this.orbitalRadius*(i/s),this.y=mouse.y+Math.sin(a)*this.orbitalRadius*(i/s)}else{this.isOrbiting=!1;const a=t/i,n=e/i,c=(s-i)/s,h=.18*Math.sin(animationTime+.01*i),r=-n*h*c,l=a*h*c;this.magneticForce.x=a*c*this.density*o*.5+r,this.magneticForce.y=n*c*this.density*o*.5+l,this.x+=.15*this.magneticForce.x,this.y+=.15*this.magneticForce.y}const n=1-i/s;this.size=this.baseSize*(1+2*n),this.opacity=this.baseOpacity*(1+n),this.energy=Math.min(100,this.energy+10*n)}else{this.isOrbiting=!1,this.magneticForce.x*=.95,this.magneticForce.y*=.95;const t=.012*(this.baseX-this.x),e=.012*(this.baseY-this.y);this.x+=t,this.y+=e,this.size+=.05*(this.baseSize-this.size),this.opacity+=.05*(this.baseOpacity-this.opacity),this.energy*=.99}}else{this.isOrbiting=!1,this.magneticForce.x*=.9,this.magneticForce.y*=.9;const t=.22*Math.sin(animationTime+.001*this.baseX),e=.22*Math.cos(animationTime+.001*this.baseY);this.baseX+=.25*(this.speedX+t),this.baseY+=.25*(this.speedY+e),this.x+=.01*(this.baseX-this.x),this.y+=.01*(this.baseY-this.y),this.size+=.05*(this.baseSize-this.size),this.opacity+=.05*(this.baseOpacity-this.opacity),this.energy*=.99}(this.baseX<0||this.baseX>canvas.width)&&(this.speedX*=-.8,this.baseX=Math.max(0,Math.min(canvas.width,this.baseX))),(this.baseY<0||this.baseY>canvas.height)&&(this.speedY*=-.8,this.baseY=Math.max(0,Math.min(canvas.height,this.baseY))),this.pulsePhase+=.008;Math.sin(this.pulsePhase);this.angle+=this.angleSpeed}draw(){if(this.trail.length>1)for(let t=0;t<this.trail.length-1;t++){const e=this.trail[t],i=this.trail[t+1],s=(1-t/this.trail.length)*e.opacity*.3;ctx.strokeStyle=`rgba(255, 0, 60, ${s})`,ctx.lineWidth=this.size*(1-t/this.trail.length)*.5,ctx.beginPath(),ctx.moveTo(e.x,e.y),ctx.lineTo(i.x,i.y),ctx.stroke()}const t=Math.min(1,this.energy/100),e=this.size*(1+.1*Math.sin(this.pulsePhase));if(t>.1){const i=ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,3*e);i.addColorStop(0,`rgba(255, 0, 60, ${this.opacity*t*.3})`),i.addColorStop(1,"rgba(255, 0, 60, 0)"),ctx.fillStyle=i,ctx.beginPath(),ctx.arc(this.x,this.y,3*e,0,2*Math.PI),ctx.fill()}const i=this.energy/100,s=Math.floor(this.colorIndex+2*i)%particleColors.length;ctx.globalAlpha=this.opacity,ctx.fillStyle=particleColors[s],ctx.beginPath(),ctx.arc(this.x,this.y,e,0,2*Math.PI),ctx.fill(),i>.3&&(ctx.fillStyle=`rgba(255, 255, 255, ${.5*i})`,ctx.beginPath(),ctx.arc(this.x,this.y,.3*e,0,2*Math.PI),ctx.fill()),ctx.globalAlpha=1}}function connectParticles(){for(let t=0;t<particles.length;t++)for(let e=t+1;e<particles.length;e++){const i=particles[t].x-particles[e].x,s=particles[t].y-particles[e].y,a=Math.sqrt(i*i+s*s),o=window.innerWidth<768?80:120,n=(particles[t].energy+particles[e].energy)/200,c=o*(1+.5*n);if(a<c){let i=1-a/c;i*=1+.5*n;i*=.3*Math.sin(animationTime+.01*a)+.7;const s=.5*(1+n);if(n>.3){const s=ctx.createLinearGradient(particles[t].x,particles[t].y,particles[e].x,particles[e].y);s.addColorStop(0,`rgba(255, 0, 60, ${i})`),s.addColorStop(.5,`rgba(255, 80, 120, ${1.2*i})`),s.addColorStop(1,`rgba(255, 0, 60, ${i})`),ctx.strokeStyle=s}else ctx.strokeStyle=`rgba(255, 0, 60, ${i})`;ctx.lineWidth=s,ctx.beginPath(),ctx.moveTo(particles[t].x,particles[t].y),ctx.lineTo(particles[e].x,particles[e].y),ctx.stroke(),n>.6&&(ctx.strokeStyle=`rgba(255, 120, 160, ${.3*i})`,ctx.lineWidth=.3*s,ctx.beginPath(),ctx.moveTo(particles[t].x,particles[t].y),ctx.lineTo(particles[e].x,particles[e].y),ctx.stroke())}}if(null!==mouse.x&&null!==mouse.y){const t=ctx.createRadialGradient(mouse.x,mouse.y,0,mouse.x,mouse.y,mouse.radius);t.addColorStop(0,"rgba(255, 0, 60, 0.1)"),t.addColorStop(.7,"rgba(255, 0, 60, 0.05)"),t.addColorStop(1,"rgba(255, 0, 60, 0)"),ctx.fillStyle=t,ctx.beginPath(),ctx.arc(mouse.x,mouse.y,mouse.radius,0,2*Math.PI),ctx.fill(),particles.forEach(t=>{const e=mouse.x-t.x,i=mouse.y-t.y,s=Math.sqrt(e*e+i*i);if(s<mouse.radius){const e=.8*(1-s/mouse.radius),i=t.energy/100,a=ctx.createLinearGradient(mouse.x,mouse.y,t.x,t.y);if(a.addColorStop(0,`rgba(255, 80, 120, ${e})`),a.addColorStop(.6,`rgba(255, 0, 60, ${.8*e})`),a.addColorStop(1,`rgba(255, 40, 80, ${.6*e})`),ctx.strokeStyle=a,ctx.lineWidth=1.5+i,ctx.beginPath(),ctx.moveTo(mouse.x,mouse.y),ctx.lineTo(t.x,t.y),ctx.stroke(),i>.5&&Math.random()>.7){const i=(mouse.x+t.x)/2,s=(mouse.y+t.y)/2,a=40*(Math.random()-.5),o=40*(Math.random()-.5);ctx.strokeStyle=`rgba(255, 200, 220, ${.4*e})`,ctx.lineWidth=.5,ctx.beginPath(),ctx.moveTo(mouse.x,mouse.y),ctx.quadraticCurveTo(i+a,s+o,t.x,t.y),ctx.stroke()}if(i>.7){const i=20+10*Math.sin(3*animationTime);ctx.strokeStyle=`rgba(255, 0, 60, ${.2*e})`,ctx.lineWidth=1,ctx.beginPath(),ctx.arc(t.x,t.y,i,0,2*Math.PI),ctx.stroke()}}});const e=Math.sqrt(mouse.velocity.x**2+mouse.velocity.y**2);if(e>2)for(let t=0;t<2*Math.PI;t+=Math.PI/6){const i=.7*mouse.radius,s=mouse.x+Math.cos(t+2*animationTime)*i,a=mouse.y+Math.sin(t+2*animationTime)*i;ctx.fillStyle=`rgba(255, 0, 60, ${.02*e})`,ctx.beginPath(),ctx.arc(s,a,2,0,2*Math.PI),ctx.fill()}}}function init(){canvas.width=window.innerWidth,canvas.height=window.innerHeight,particles=[];const t=isLowPowerDevice?window.innerWidth<768?28:48:window.innerWidth<768?44:90;for(let e=0;e<t;e++){const t=Math.random()*canvas.width,e=Math.random()*canvas.height;particles.push(new Particle(t,e))}}function animate(t=0){t-lastFrameTime<frameInterval||(lastFrameTime=t,ctx.fillStyle="rgba(18, 18, 18, 0.1)",ctx.fillRect(0,0,canvas.width,canvas.height),particles.forEach(t=>{t.update(),t.draw()}),connectParticles(),animationTime+=.006),requestAnimationFrame(animate)}canvas.addEventListener("mousemove",t=>{const e=t.clientX-canvasRect.left,i=t.clientY-canvasRect.top;null!==mouse.x&&null!==mouse.y&&(mouse.velocity.x=e-mouse.x,mouse.velocity.y=i-mouse.y),mouse.x=e,mouse.y=i,mouse.trail.unshift({x:mouse.x,y:mouse.y,time:Date.now()}),mouse.trail.length>10&&mouse.trail.pop()},{passive:!0}),canvas.addEventListener("mouseleave",()=>{mouse.x=null,mouse.y=null,mouse.velocity={x:0,y:0},mouse.trail=[]},{passive:!0}),canvas.addEventListener("touchmove",t=>{t.preventDefault();const e=t.touches[0],i=e.clientX-canvasRect.left,s=e.clientY-canvasRect.top;null!==mouse.x&&null!==mouse.y&&(mouse.velocity.x=i-mouse.x,mouse.velocity.y=s-mouse.y),mouse.x=i,mouse.y=s,mouse.trail.unshift({x:mouse.x,y:mouse.y,time:Date.now()}),mouse.trail.length>10&&mouse.trail.pop()},{passive:!1}),canvas.addEventListener("touchend",()=>{mouse.x=null,mouse.y=null,mouse.velocity={x:0,y:0},mouse.trail=[]},{passive:!0}),window.addEventListener("resize",()=>{init(),canvasRect=canvas.getBoundingClientRect()}),window.addEventListener("scroll",()=>{canvasRect=canvas.getBoundingClientRect()},{passive:!0}),canvas?(init(),prefersReducedMotion?(ctx.fillStyle="rgba(18, 18, 18, 1)",ctx.fillRect(0,0,canvas.width,canvas.height),particles.forEach(t=>{t.draw()}),connectParticles()):animate()):console.error("Network animation canvas not found");